define("local_learningplan/learningplan",["jquery","core/ajax"],(function($,ajax){return{init:function(){$(document).on("click",".remove-section-btn",(function(){let button=$(this),courseId=button.data("courseid"),sectionId=button.data("sectionid"),userId=button.data("userid");ajax.call([{methodname:"local_learningplan_delete_section_data",args:{courseid:courseId,sectionid:sectionId,userid:userId},done:function(){$('tr[data-sectionid="'+sectionId+'"]').fadeOut(300,(function(){$(this).remove()}))},fail:function(error){console.error("Error when removing the section:",error)}}])})),$(".datepicker").on("change",(function(){let input=$(this),courseId=input.data("courseid"),sectionId=input.data("sectionid"),userId=input.data("userid"),newDeadline=input.val();ajax.call([{methodname:"local_learningplan_update_deadline",args:{courseid:courseId,sectionid:sectionId,userid:userId,deadline:newDeadline},done:function(){},fail:function(error){console.error("Error when saving the deadline:",error)}}])})),$(".progress-dropdown").on("change",(function(){let input=$(this),row=input.closest(".learningplan-section"),courseId=input.data("courseid"),sectionId=input.data("sectionid"),userId=input.data("userid"),newProgress=input.val();ajax.call([{methodname:"local_learningplan_update_progress",args:{courseid:courseId,sectionid:sectionId,userid:userId,progress:newProgress},done:function(){row.attr("data-progress",newProgress),filterTable()},fail:function(error){console.error("Error when saving the processing status:",error)}}])}));const searchInput=$("#searchInput"),filterSelect=$("#filterSelect");function filterTable(){let searchText=searchInput.val().toLowerCase(),filterValue=filterSelect.val().toLowerCase();$(".learningplan-section").each((function(){let row=$(this),courseName=row.find("td").eq(0).text().toLowerCase(),sectionName=row.find("td").eq(1).text().toLowerCase(),progress=row.attr("data-progress").toLowerCase(),timeCreated=row.find("td").eq(2).text().trim(),deadlineInput=row.find("td").eq(3).find("input"),processingDeadline=deadlineInput.length?deadlineInput.val():"";processingDeadline=function(dateString){let parts=dateString.split("-");if(3===parts.length)return`${parts[2]}.${parts[1]}.${parts[0]}`;return dateString}(processingDeadline);let matchesSearch=courseName.includes(searchText)||sectionName.includes(searchText)||timeCreated.includes(searchText)||processingDeadline.includes(searchText),matchesFilter=""===filterValue||progress===filterValue;row.toggle(matchesSearch&&matchesFilter)}))}searchInput.on("keyup",filterTable),filterSelect.on("change",filterTable);let sortDirection={};function getCellValue(row,column){let cell=row.find("td").eq(function(column){return["coursename","sectionname","addeddate","processing_deadline","progress"].indexOf(column)}(column));return"processing_deadline"===column?new Date(cell.find("input").val()).getTime()||0:"progress"===column?cell.find("select").val():"addeddate"===column?new Date(cell.text().trim().split(".").reverse().join("-")).getTime()||0:cell.text().trim()}$(".sortable").on("click",(function(){let column=$(this).data("column"),tableBody=$("#learningPlanTable tbody"),rows=tableBody.find("tr").toArray();sortDirection[column]=!sortDirection[column],rows.sort((function(rowA,rowB){return(getCellValue($(rowA),column)<getCellValue($(rowB),column)?-1:1)*(sortDirection[column]?1:-1)})),$.each(rows,(function(index,row){tableBody.append(row)})),$(".sortable").each((function(){let column=$(this).data("column");sortDirection[column]?$(this).addClass("sorted-asc").removeClass("sorted-desc"):$(this).addClass("sorted-desc").removeClass("sorted-asc")}))}))}}}));

//# sourceMappingURL=learningplan.min.js.map