define("local_learningplan/sectionmenu",["jquery","core/ajax"],(function($,ajax){return{init:function(){console.log("Lernplan-Menüerweiterung geladen."),$(document).on("click",".section-actions .dropdown-toggle",(function(){var _$$closest$attr;let menu=$(this).closest(".dropdown").find(".dropdown-menu");if(!menu.length||menu.find(".learningplan-menu-item").length)return;let sectionId=null===(_$$closest$attr=$(this).closest(".section").attr("id"))||void 0===_$$closest$attr?void 0:_$$closest$attr.replace("section-",""),courseId=$("body").attr("class").match(/course-(\d+)/);courseId=courseId?courseId[1]:null,sectionId&&courseId&&ajax.call([{methodname:"local_learningplan_get_section_option",args:{sectionid:sectionId,courseid:courseId},done:function(response){let menuItem=$('<a href="#" class="dropdown-item learningplan-menu-item">').html('<i class="icon fa fa-list-alt fa-fw"></i> '+(1==response?"Lernplan deaktivieren":"Lernplan aktivieren")).on("click",(function(e){e.preventDefault(),function(sectionId,courseId,menuItem){ajax.call([{methodname:"local_learningplan_toggle_section_option",args:{sectionid:sectionId,courseid:courseId},done:function(newvalue){let newText=1==newvalue?"Lernplan deaktivieren":"Lernplan aktivieren";menuItem.html('<i class="icon fa fa-list-alt fa-fw"></i> '+newText),console.log("Lernplan-Einstellung für Abschnitt "+sectionId+" geändert!");let sectionButton=$('[data-section-id="'+sectionId+'"].learningplan-save-button');console.log("Suche Button für sectionId:",sectionId),console.log("Gefundene Elemente:",sectionButton.length),0===newvalue?(sectionButton.hide(),ajax.call([{methodname:"local_learningplan_delete_section_data_for_all",args:{courseid:courseId,sectionid:sectionId},done:function(){console.log("Lernplan-Eintrag für Abschnitt "+sectionId+" wurde für alle User entfernt."),sectionButton.find("i").removeClass("fa-trash").addClass("fa-save"),sectionButton.removeClass("btn-danger").addClass("btn-primary")},fail:function(error){console.error("Fehler beim Entfernen des Lernplan-Eintrags:",error),console.log("Section id="+sectionId+" Courseid="+courseId),console.log("Nachricht aus der Toggle Funktion")}}])):sectionButton.show()},fail:function(error){console.error("Fehler beim Umschalten:",error)}}])}(sectionId,courseId,menuItem)}));menu.append(menuItem),console.log("Menüeintrag für Abschnitt "+sectionId+" hinzugefügt.");let sectionButton=$(".section-"+sectionId+" .learningplan-save-button");0===response?(sectionButton.hide(),ajax.call([{methodname:"local_learningplan_delete_section_data_for_all",args:{courseid:courseId,sectionid:sectionId},done:function(){console.log("Lernplan-Eintrag für Abschnitt "+sectionId+" wurde für alle User entfernt."),sectionButton.find("i").removeClass("fa-trash").addClass("fa-save"),sectionButton.removeClass("btn-danger").addClass("btn-primary")},fail:function(error){console.error("Fehler beim Entfernen des Lernplan-Eintrags:",error),console.log("Section id="+sectionId+" Courseid="+courseId),console.log("Nachricht aus der Basis Funktion")}}])):sectionButton.show()},fail:function(error){console.error("Fehler beim Abrufen der Einstellung:",error)}}])}))}}}));

//# sourceMappingURL=sectionmenu.min.js.map