define("local_learningplan/sectionmenu",["jquery","core/ajax"],(function($,ajax){return{init:function(){console.log("Lernplan-Menüerweiterung geladen."),$(document).on("click",".section-actions .dropdown-toggle",(function(){let menu=$(this).closest(".dropdown").find(".dropdown-menu");if(!menu.length||menu.find(".learningplan-menu-item").length)return;let sectionId=$(this).closest(".section-actions").data("sectionid"),courseId=$("body").attr("class").match(/course-(\d+)/);courseId=courseId?courseId[1]:null,sectionId&&courseId&&ajax.call([{methodname:"local_learningplan_get_section_option",args:{sectionid:sectionId,courseid:courseId},done:function(response){let menuItem=$('<a href="#" class="dropdown-item learningplan-menu-item">').html('<i class="icon fa fa-list-alt fa-fw"></i> '+(1==response?"Nicht zum Lernplan hinzufügbar":"Zum Lernplan hinzufügbar")).on("click",(function(e){e.preventDefault(),function(sectionId,courseId,menuItem){ajax.call([{methodname:"local_learningplan_toggle_section_option",args:{sectionid:sectionId,courseid:courseId},done:function(newvalue){let newText=1==newvalue?"Nicht zum Lernplan hinzufügbar":"Zum Lernplan hinzufügbar";menuItem.html('<i class="icon fa fa-list-alt fa-fw"></i> '+newText),console.log("Lernplan-Einstellung für Abschnitt "+sectionId+" geändert!");let sectionButton=$(".section-"+sectionId+" .learningplan-save-button");0==newvalue?sectionButton.hide():sectionButton.show()},fail:function(error){console.error("Fehler beim Umschalten:",error)}}])}(sectionId,courseId,menuItem)}));menu.append(menuItem),console.log("Menüeintrag für Abschnitt "+sectionId+" hinzugefügt.");let sectionButton=$(".section-"+sectionId+" .learningplan-save-button");0==response?sectionButton.hide():sectionButton.show()},fail:function(error){console.error("Fehler beim Abrufen der Einstellung:",error)}}])}))}}}));

//# sourceMappingURL=sectionmenu.min.js.map