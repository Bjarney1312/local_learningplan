define("local_learningplan/button",["jquery","core/ajax"],(function($,ajax){return{init:function(params){console.log("JavaScript wird geladen!");var userId=params,courseId=$("body").attr("class").match(/course-(\d+)/);courseId=courseId?courseId[1]:null,userId&&courseId?($(".sectionname").each((function(){var sectionTitle=$(this),sectionId=sectionTitle.closest('[id^="section-"]').attr("id").replace("section-","");if(!sectionTitle.find(".learningplan-save-button").length){let button=$("<button>").addClass("btn btn-icon btn-primary learningplan-save-button").attr("data-section-id",sectionId).attr("data-course-id",courseId).attr("data-user-id",userId).html('<i class="icon fa fa-save"></i>');ajax.call([{methodname:"local_learningplan_check_section_data",args:{courseid:courseId,sectionid:sectionId,userid:userId},done:function(response){console.log("Server-Antwort learningplan_check: "+response);let icon=button.find("i");console.log(icon.hasClass("fa-save")),response?(console.log("Ändere Button zu trash"),icon.hasClass("fa-save")&&(icon.removeClass("fa-save").addClass("fa-trash"),button.removeClass("btn-primary").addClass("btn-danger"))):(console.log("Ändere Button zu save"),icon.hasClass("fa-trash")&&(icon.removeClass("fa-trash").addClass("fa-save"),button.removeClass("btn-danger").addClass("btn-primary")))},fail:function(error){console.error("Fehler:",error)}}]),sectionTitle.prepend(button)}})),$(document).on("click",".learningplan-save-button",(function(){var button=$(this),courseId=button.data("course-id"),sectionId=button.data("section-id"),userId=button.data("user-id"),currentIcon=button.find("i");currentIcon.hasClass("fa-save")?ajax.call([{methodname:"local_learningplan_save_section_data",args:{courseid:courseId,sectionid:sectionId,userid:userId},done:function(){currentIcon.removeClass("fa-save").addClass("fa-trash"),button.removeClass("btn-primary").addClass("btn-danger")},fail:function(error){console.log("Fehler:",error),alert("Fehler beim Speichern der Daten.")}}]):currentIcon.hasClass("fa-trash")&&ajax.call([{methodname:"local_learningplan_delete_section_data",args:{courseid:courseId,sectionid:sectionId,userid:userId},done:function(){currentIcon.removeClass("fa-trash").addClass("fa-save"),button.removeClass("btn-danger").addClass("btn-primary")},fail:function(error){console.log("Fehler:",error),alert("Fehler beim Entfernen der Daten.")}}])}))):console.error("Fehler: userId oder courseId fehlen!")}}}));

//# sourceMappingURL=button.min.js.map